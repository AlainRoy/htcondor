SRC_DIR = $(SRC_TREE)/condor_tools
CFLAGS = $(STD_C_FLAGS) $(PLATFORM_C_FLAGS) -DNEW_PROC
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) -DNEW_PROC -DALLOC_DEBUG -fexternal-templates
#remove static for libdl.so
LDFLAGS = $(LIBDBM)

#if IS_V6
CLASSAD_LIB = ../condor_classad/expr_lib.a
PREEN_SRC = preen.C
PREEN_OBJ = preen.o
#else
PREEN_SRC = preenV5.C
PREEN_OBJ = preenV5.o
#endif

SRC =  \
	config_val.c history.C $(PREEN_SRC) reconfig_schedd.C reschedule.C status.C \
	summary.C vacate.C block_jobs.c custom.C custom_main.C  info.c\
	jobQueueCheck.C checkpoint.C

#if IS_V6
LIB= ../condor_c++_util/cplus_lib.a $(CLASSAD_LIB) ../condor_util_lib/util_lib.a RpcLib KernLib SocketLib
LIBDIRS =../condor_util_lib ../condor_c++_util
PROGRAMS =  \
	config_val condor_preen condor_reconfig_schedd \
	condor_reschedule condor_vacate \
	block_jobs condor_customize condor_checkpoint
#else
LIB= ../condor_c++_util/cplus_lib.a ../condor_util_lib/util_lib.a ../condor_xdr_lib/xdr_lib.a RpcLib KernLib SocketLib
LIBDIRS =../condor_util_lib ../condor_xdr_lib ../condor_c++_util
PROGRAMS =  \
	config_val condor_history condor_preen condor_reconfig_schedd \
	condor_reschedule condor_status condor_summary condor_vacate \
	block_jobs condor_customize condor_jobqueue condor_schedd_info condor_checkpoint
#endif

all_target( $(PROGRAMS) )
tags_target($(SRC),$(LIBDIRS))
depend_target($(SRC))

c_plus_target(condor_summary,summary.o,$(LIB))

c_plus_target(condor_history,history.o,$(LIB))

#if IS_V6
c_plus_target(condor_preen,$(PREEN_OBJ),../condor_schedd.V6/libqmgmt.a ../condor_classad/expr_lib.a $(LIB))
#else
c_plus_target(condor_preen,$(PREEN_OBJ),$(LIB))
release_target(condor_summary,$(RELEASE_DIR)/bin,SET_GID_MODE)
release_target(condor_history,$(RELEASE_DIR)/bin,SET_GID_MODE)
release_target(condor_jobqueue,$(RELEASE_DIR)/bin,SET_GID_MODE)
release_target(condor_schedd_info,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
c_plus_target(condor_status,status.o status_aggregates.o status_include.o,$(LIB))
release_target(condor_status,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
#endif
release_target(condor_preen,$(RELEASE_DIR)/bin,SET_GID_MODE)

c_plus_target(condor_jobqueue,jobQueueCheck.o,$(LIB))

c_plus_target(condor_userprio,user_prio.o,$(LIB))
release_target(condor_userprio,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_customize,custom.o custom_main.o,$(LIB))
release_target(condor_customize,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(config_val,config_val.o,$(LIB))
release_target(config_val,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_reconfig_schedd,reconfig_schedd.o,$(LIB))
release_target(condor_reconfig_schedd,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_reschedule,reschedule.o,$(LIB))
release_target(condor_reschedule,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_vacate,vacate.o,$(LIB))
release_target(condor_vacate,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(condor_checkpoint,checkpoint.o,$(LIB))
release_target(condor_checkpoint,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)

c_plus_target(block_jobs,block_jobs.o,$(LIB))

program_target(condor_schedd_info,info.o,$(LIB))
