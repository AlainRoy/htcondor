#! /usr/bin/env perl
#! /usr/bin/perl -w
use strict;
# use warnings;

# How to run the cluster tool...
print "Old:\n";
{
    my $Tool = "/unsup/condor/bin/condor_cluster_tool";
    my $ToolArgs = "check";

    # Run the cluster tool...
    my $Cmd = "$Tool $ToolArgs";
    die "Can't run '$Cmd'" if ( ! open( IN, "$Cmd|" )  );
    while ( <IN> )
    {
	print;
	chomp;
	if ( /(.*): Condor is (\w+)/ )
	{
	    my $Host = $1;
	    my $Status = $2;
	    if ( ( $Status eq "off" ) || ( /reserved/ )  )
	    {
		print "$Host\n";
	    }
	}
    }
    close( IN );
}

print "New:\n";
# How to run the NEW cluster tool...
{
    my $Tool = "/unsup/condor/bin/condor_new_cluster_tool";
    my $ToolArgs = "check";

    # Run the cluster tool...
    my $Cmd = "$Tool $ToolArgs";
    die "Can't run '$Cmd'" if ( ! open( IN, "$Cmd|" )  );
    while ( <IN> )
    {
	print;
	chomp;
	if ( /(.*)\s+is\s+(\S+)/ )
	{
	    my $Host = $1;
	    my $Status = $2;
	    print "$Host\n" if ( $Status eq "reserved" );
	}
    }
    close( IN );
}
