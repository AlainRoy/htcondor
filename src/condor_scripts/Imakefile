all_target(condor_install condor_init condor_compile ld)

CFLAGS = $(STD_C_FLAGS)

/* Set up where I get the glibc libraries for packaging with the release */
#if IS_GLIBC21
GLIBC_DIR = /p/condor/workspaces/glibc/glibc-install/lib
#elif IS_GLIBC22
GLIBC_DIR = /p/condor/workspaces/glibc/glibc-install/lib-glibc2.2.2/lib
#endif

release_copy_target(condor_install,$(RELEASE_DIR)/sbin,condor_install,EXECUTABLE_MODE)
release_copy_target(condor_init,$(RELEASE_DIR)/sbin,condor_init,EXECUTABLE_MODE)
#if IS_CLIPPED
release_copy_target(condor_compile.clipped,bin,condor_compile,EXECUTABLE_MODE)
#else 
release_copy_target(condor_compile,bin,condor_compile,EXECUTABLE_MODE)
release_copy_target(ld,lib,ld,EXECUTABLE_MODE)
release_link_target($(RELEASE_DIR)/lib/ld,lib,real-ld)
#endif /* IS_CLIPPED */

strip_copy_target(condor_install,$(STRIP_DIR)/sbin,condor_install,EXECUTABLE_MODE)
strip_copy_target(condor_init,$(STRIP_DIR)/sbin,condor_init,EXECUTABLE_MODE)
strip_copy_target(condor_cleanckpts,$(STRIP_CONTRIB)/sbin,condor_cleanckpts,EXECUTABLE_MODE)
#if IS_CLIPPED
strip_copy_target(condor_compile.clipped,$(STRIP_DIR)/bin, \
		condor_compile,EXECUTABLE_MODE)
#else 
strip_copy_target(condor_compile,$(STRIP_DIR)/bin,condor_compile,EXECUTABLE_MODE)
strip_copy_target(ld,$(STRIP_DIR)/lib,ld,EXECUTABLE_MODE)
strip_link_target($(STRIP_DIR)/lib/ld,lib,real-ld)
#endif /* IS_CLIPPED */

static_copy_target(condor_install,$(STATIC_DIR)/sbin,condor_install,EXECUTABLE_MODE)
static_copy_target(condor_init,$(STATIC_DIR)/sbin,condor_init,EXECUTABLE_MODE)
static_copy_target(condor_cleanckpts,$(STATIC_CONTRIB)/sbin,condor_cleanckpts,EXECUTABLE_MODE)
#if IS_CLIPPED
static_copy_target(condor_compile.clipped,$(STATIC_DIR)/bin, \
		condor_compile,EXECUTABLE_MODE)
#else 
static_copy_target(condor_compile,$(STATIC_DIR)/bin,condor_compile, \
		EXECUTABLE_MODE)
static_copy_target(ld,$(STATIC_DIR)/lib,ld,EXECUTABLE_MODE)
static_link_target($(STATIC_DIR)/lib/ld,lib,real-ld)
#endif /* IS_CLIPPED */

#if ! IS_CLIPPED
all_symlink_target(ld,real-ld)
#endif /* ! IS_CLIPPED */

/* WARNING. Ok, here's the deal on why this is here: glibc 2.1.3 added/renamed
	some libc calls that broke how we trap stuff. So in order to
	not have a release tar ball for EACH redhat release, be just
	ship glibc 2.1.1 with it in the condor/lib directory(it will
	automatically get used before the real libc courtesy of -L on
	the link line). This will be the case until we hit a set of
	header files that can't be used with glibc 2.1.1. */
#if IS_GLIBC21 || IS_GLIBC22
#if ! IS_CLIPPED
release_copy_target($(GLIBC_DIR)/libc.a,$(RELEASE_DIR)/lib,libc.a,OBJECT_MODE)
static_copy_target($(GLIBC_DIR)/libc.a,$(STATIC_DIR)/lib,libc.a,OBJECT_MODE)
strip_copy_target($(GLIBC_DIR)/libc.a,$(STRIP_DIR)/lib,libc.a,OBJECT_MODE)

release_copy_target($(GLIBC_DIR)/libnss_files.a,$(RELEASE_DIR)/lib,libnss_files.a,OBJECT_MODE)
static_copy_target($(GLIBC_DIR)/libnss_files.a,$(STATIC_DIR)/lib,libnss_files.a,OBJECT_MODE)
strip_copy_target($(GLIBC_DIR)/libnss_files.a,$(STRIP_DIR)/lib,libnss_files.a,OBJECT_MODE)

release_copy_target($(GLIBC_DIR)/libnss_dns.a,$(RELEASE_DIR)/lib,libnss_dns.a,OBJECT_MODE)
static_copy_target($(GLIBC_DIR)/libnss_dns.a,$(STATIC_DIR)/lib,libnss_dns.a,OBJECT_MODE)
strip_copy_target($(GLIBC_DIR)/libnss_dns.a,$(STRIP_DIR)/lib,libnss_dns.a,OBJECT_MODE)

release_copy_target($(GLIBC_DIR)/libresolv.a,$(RELEASE_DIR)/lib,libresolv.a,OBJECT_MODE)
static_copy_target($(GLIBC_DIR)/libresolv.a,$(STATIC_DIR)/lib,libresolv.a,OBJECT_MODE)
strip_copy_target($(GLIBC_DIR)/libresolv.a,$(STRIP_DIR)/lib,libresolv.a,OBJECT_MODE)

release_plain_symlink_target($(RELEASE_DIR)/lib/libresolv.a,libresolv.a)
release_plain_symlink_target($(RELEASE_DIR)/lib/libc.a,libc.a)
release_plain_symlink_target($(RELEASE_DIR)/lib/libnss_files.a,libnss_files.a)
release_plain_symlink_target($(RELEASE_DIR)/lib/libnss_dns.a,libnss_dns.a)
#endif
#endif

#if IS_IRIX
release_link_target($(RELEASE_DIR)/lib/ld,lib,uld)
release_link_target($(RELEASE_DIR)/lib/ld,lib,old_ld)
release_link_target($(RELEASE_DIR)/lib/ld,lib,ld32)
release_symlink_target(/usr/lib/c++/c++filt,lib,c++filt)
release_symlink_target(/usr/lib/c++/c++patch,lib,c++patch)
release_symlink_target(/usr/lib/c++/cfront,lib,cfront)
release_symlink_target(/usr/lib/c++/markc++,lib,markc++)
release_symlink_target(/usr/lib/c++/ptcomp,lib,ptcomp)
release_symlink_target(/usr/lib/c++/ptlink,lib,ptlink)

strip_link_target($(STRIP_DIR)/lib/ld,lib,uld)
strip_link_target($(STRIP_DIR)/lib/ld,lib,old_ld)
strip_link_target($(STRIP_DIR)/lib/ld,lib,ld32)
strip_symlink_target(/usr/lib/c++/c++filt,lib,c++filt)
strip_symlink_target(/usr/lib/c++/c++patch,lib,c++patch)
strip_symlink_target(/usr/lib/c++/cfront,lib,cfront)
strip_symlink_target(/usr/lib/c++/markc++,lib,markc++)
strip_symlink_target(/usr/lib/c++/ptcomp,lib,ptcomp)
strip_symlink_target(/usr/lib/c++/ptlink,lib,ptlink)

static_link_target($(STATIC_DIR)/lib/ld,lib,uld)
static_link_target($(STATIC_DIR)/lib/ld,lib,old_ld)
static_link_target($(STATIC_DIR)/lib/ld,lib,ld32)
static_symlink_target(/usr/lib/c++/c++filt,lib,c++filt)
static_symlink_target(/usr/lib/c++/c++patch,lib,c++patch)
static_symlink_target(/usr/lib/c++/cfront,lib,cfront)
static_symlink_target(/usr/lib/c++/markc++,lib,markc++)
static_symlink_target(/usr/lib/c++/ptcomp,lib,ptcomp)
static_symlink_target(/usr/lib/c++/ptlink,lib,ptlink)

all_symlink_target(ld,uld)
all_symlink_target(ld,old_ld)
all_symlink_target(ld,ld32)
all_symlink_target(/usr/lib/c++/c++filt,c++filt)
all_symlink_target(/usr/lib/c++/c++patch,c++patch)
all_symlink_target(/usr/lib/c++/cfront,cfront)
all_symlink_target(/usr/lib/c++/markc++,markc++)
all_symlink_target(/usr/lib/c++/ptcomp,ptcomp)
all_symlink_target(/usr/lib/c++/ptlink,ptlink)
#endif

release_copy_target(Condor.pm,$(RELEASE_DIR)/lib,Condor.pm,OBJECT_MODE)
strip_copy_target(Condor.pm,$(STRIP_DIR)/lib,Condor.pm,OBJECT_MODE)
static_copy_target(Condor.pm,$(STATIC_DIR)/lib,Condor.pm,OBJECT_MODE)

release_copy_target(condor_run,bin,condor_run,EXECUTABLE_MODE)
strip_copy_target(condor_run,bin,condor_run,EXECUTABLE_MODE)
static_copy_target(condor_run,bin,condor_run,EXECUTABLE_MODE)

clean::
html:
