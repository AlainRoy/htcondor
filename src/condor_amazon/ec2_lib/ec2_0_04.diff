--- /u/j/y/jyoon/EC2.pm	Thu Apr 17 17:02:28 2008
+++ ./EC2.pm	Sat Apr 12 10:52:16 2008
@@ -209,6 +209,7 @@ sub register_image {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -295,6 +296,7 @@ sub describe_images {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 		
 		return undef;
 	}
@@ -331,6 +333,7 @@ sub deregister_image {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -429,6 +432,7 @@ sub run_instances {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -506,6 +510,7 @@ sub describe_instances {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -583,6 +588,7 @@ sub terminate_instances {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -640,6 +646,7 @@ sub create_key_pair {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -694,6 +701,7 @@ sub describe_key_pairs {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -733,6 +741,7 @@ sub delete_key_pair {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -795,6 +804,7 @@ sub modify_image_attribute {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -835,6 +845,7 @@ sub reset_image_attribute {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -876,6 +887,7 @@ sub create_security_group {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -947,6 +959,7 @@ sub describe_security_groups {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -983,6 +996,7 @@ sub delete_security_group {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1059,6 +1073,7 @@ sub authorize_security_group_ingress {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1135,6 +1150,7 @@ sub revoke_security_group_ingress {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1171,6 +1187,7 @@ sub get_console_output {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1216,6 +1233,7 @@ sub reboot_instances {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1266,6 +1284,7 @@ sub describe_image_attribute {
 	if ( grep { defined && length } $xml->{Errors} ) {
 		$self->_debug("ERROR: $xml->{Errors}{Error}{Message}");
 		$self->{error} = $xml->{Errors}{Error}{Message};
+		$self->{errorcode} = $xml->{Errors}{Error}{Code};
 
 		return undef;
 	}
@@ -1306,4 +1325,4 @@ under the same terms as Perl itself.
 
 =head1 SEE ALSO
 
-Amazon EC2 API: L<http://docs.amazonwebservices.com/AmazonEC2/dg/2007-01-19/>
\ No newline at end of file
+Amazon EC2 API: L<http://docs.amazonwebservices.com/AmazonEC2/dg/2007-01-19/>
