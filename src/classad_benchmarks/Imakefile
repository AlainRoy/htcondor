PROGRAMS = \
	cabench_query-newcol \
	cabench_query-oldcol

all_target( $(PROGRAMS) )
new:	cabench_query-newcol
old:	cabench_query-oldcol


CFLAGS = $(STD_C_FLAGS)
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS)
LIB = $(STD_LIBS)

OBJ =	\
	cabench_adwrap_base.o		\
	cabench_adwrap_new.o		\
	cabench_adwrap_old.o		\
	cabench_query_options.o		\
	cabench_query_base.o		\
	cabench_query_new_collection.o	\
	cabench_query_old_collection.o


# Individual targets
new: cabench_query-new_col
c_plus_target(cabench_query-newcol,$(OBJ) cabench_query-newcol.o,$(LIB))
old: cabench_query-oldcol
c_plus_target(cabench_query-oldcol,$(OBJ) cabench_query-oldcol.o,$(LIB))

cabench_query-newcol.o : cabench_query_main.cpp
	$(CPlusPlus) $(C_PLUS_FLAGS) -D BENCHMARK_NEW_CLASSADS -c $< -o $@
cabench_query-oldcol.o : cabench_query_main.cpp
	$(CPlusPlus) $(C_PLUS_FLAGS) -D BENCHMARK_OLD_CLASSADS -c $< -o $@


.SUFFIXES: .ad .newad .oldad
.ad.newad:
	./convert_to_new < $< > $@
.ad.oldad:
	./convert_to_old < $< > $@
