\begin{ManPage}{\label{man-condor-advertise}\Condor{advertise}}{1}
{Send a ClassAd to the \Condor{collector} daemon}
\Synopsis \SynProg{\Condor{advertise}}
\ToolArgsBase
\oOptArg{-pool}{centralmanagerhostname[:portname]}
\oOpt{-debug}
\oOpt{-tcp}
\Arg{update-command}
\oArg{classad-filename}

\index{Condor commands!condor\_advertise}
\index{condor\_advertise command}

\Description
\Condor{advertise} sends a ClassAd to the \Condor{collector} daemon on
the central manager machine.
The ClassAd is contained in a file,
which is specified by the second required argument.
Which daemon's ClassAd to update is specified by the first
required argument.
The \Arg{update-command} may be one of the following strings:
\begin{description}
\item[UPDATE\_STARTD\_AD]
\item[UPDATE\_SCHEDD\_AD]
\item[UPDATE\_MASTER\_AD]
\item[UPDATE\_GATEWAY\_AD]
\item[UPDATE\_CKPT\_SRVR\_AD]
\item[UPDATE\_NEGOTIATOR\_AD]
\item[UPDATE\_HAD\_AD]
\item[UPDATE\_AD\_GENERIC]
\item[UPDATE\_SUBMITTOR\_AD]
\item[UPDATE\_COLLECTOR\_AD]
\item[UPDATE\_LICENSE\_AD]
\item[UPDATE\_STORAGE\_AD]
\end{description}

\Condor{advertise} can also be used to invalidate and delete
ClassAds currently held by the \Condor{collector} daemon.  In this case
the \Arg{update-command} will be one of the following strings:
\begin{description}
\item[INVALIDATE\_STARTD\_ADS]
\item[INVALIDATE\_SCHEDD\_ADS]
\item[INVALIDATE\_MASTER\_ADS]
\item[INVALIDATE\_GATEWAY\_ADS]
\item[INVALIDATE\_CKPT\_SRVR\_ADS]
\item[INVALIDATE\_NEGOTIATOR\_ADS]
\item[INVALIDATE\_HAD\_ADS]
\item[INVALIDATE\_ADS\_GENERIC]
\item[INVALIDATE\_SUBMITTOR\_ADS]
\item[INVALIDATE\_COLLECTOR\_ADS]
\item[INVALIDATE\_LICENSE\_ADS]
\item[INVALIDATE\_STORAGE\_ADS]
\end{description}

For any of these INVALIDATE commands, the ClassAd in the required file
consists of three entries.
The file contents will be similar to:
\begin{verbatim}
MyType = "Query"
TargetType = "Machine"
Requirements = Name == "condor.example.com"
\end{verbatim}
The definition for \Attr{MyType} is always \Expr{Query}.
\Attr{TargetType} is set to the \Attr{MyType} of the ad to be deleted.
This \Attr{MyType} is
\Expr{DaemonMaster} for the \Condor{master} ClassAd,
\Expr{Machine} for the \Condor{startd} ClassAd,
\Expr{Scheduler} for the \Condor{schedd} ClassAd, and
\Expr{Negotiator} for the \Condor{negotiator} ClassAd.
\Attr{Requirements} is an expression evaluated within the context
of ads of \Attr{TargetType}.
When \Attr{Requirements} evaluates to \Expr{True},
the matching ad is invalidated.  
A full example is given below.


\begin{Options}
    \ToolArgsBaseDesc
    \OptItem{\OptArgnm{-pool}{centralmanagerhostname[:portname]}}
            {Specify a pool by
            giving the central manager's hostname and an optional port
	    number.  The default is the
	    \MacroNI{COLLECTOR\_HOST} specified in the configuration file.}
    \OptItem{\Opt{-tcp}}{Use TCP for communication. Without this
        option, UDP is used.}
    \OptItem{\Opt{-debug}}{Print debugging information as the command
            executes.}
\end{Options}

\GenRem
The job and machine ClassAds are regularly updated.
Therefore, the result of \Condor{advertise} is likely to be
overwritten in a very short time.
It is unlikely that either Condor users (those who submit jobs)
or administrators will ever have a use for this command.
If it is desired to update or set a ClassAd attribute, the
\Condor{config\_val} command is the proper command to use.

For those administrators who do need \Condor{advertise}, you can 
optionally include these attributes:

DaemonStartTime - The time the service you are advertising
started running.  Measured in seconds since the Unix epoch.

UpdateSequenceNumber - An integer that begins at 0 and increments by
one each time you re-advertise the same ad.

If both of the above are included, the \Condor{collector} will
automatically include the following attributes:

UpdatesTotal - The actual number of advertisements for this
daemon that the \Condor{collector} has seen.

UpdatesLost - The number of advertisements that for this daemon
that the \Condor{collector} expected to see, but did not.

UpdatesSequenced - The total of UpdatesTotal and UpdatesLost.

UpdatesHistory - See \Macro{COLLECTOR\_DAEMON\_HISTORY\_SIZE} in
section~\ref{sec:Collector-Config-File-Entries}.

\Examples

Assume that a machine called condor.example.com is turned off,
yet its \Condor{startd} ClassAd does not expire for another 20 minutes.
To avoid this machine being matched, an administrator chooses
to delete the machine's \Condor{startd} ClassAd.
Create a file (called \File{remove\_file} in this example)
with the three required attributes:
\begin{verbatim}
MyType = "Query"
TargetType = "Machine"
Requirements = Name == "condor.example.com"
\end{verbatim}

This file is used with the command:
\begin{verbatim}
% condor_advertise INVALIDATE_STARTD_ADS remove_file 
\end{verbatim}

\ExitStatus

\Condor{advertise} will exit with a status value of 0 (zero) upon success,
and it will exit with the value 1 (one) upon failure.

\end{ManPage}
