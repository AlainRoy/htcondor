%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:Contrib-CondorView-Install}
Configuring The CondorView Server}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The CondorView server is an alternate use of the
\Condor{collector}
\index{CondorView}
that logs information on disk, providing a 
persistent, historical database of pool state.
This includes machine state, as well as the state of jobs submitted by
users.
Historical information logging can be turned on or off, so you can
install the CondorView collector without using up disk space for
historical information if you don't want it.

The CondorView collector is a \Condor{collector} that has been specially 
configured \emph{and running on a different machine from the main
\Condor{collector}}.
Unfortunately, installing the CondorView collector on a separate host
generates more network traffic (from all the duplicate updates that
are sent from each machine in your pool to both collectors).

The following sections describe how to configure a machine to run a
CondorView server and to configure your pool to send updates to it. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{\label{sec:CondorView-Server-Setup}
Configuring a Machine to be a CondorView Server} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\index{CondorView!installation|(}

To configure the CondorView collector, you have to add a few settings
to the \emph{local} configuration file of the chosen machine (a
seperate machine from the main \Condor{collector}) to enable
historical data collection.
These settings are described in detail in the Condor \VersionNotice\ 
Administrator's Manual, in
section~\ref{sec:Collector-Config-File-Entries} on
page~\pageref{sec:Collector-Config-File-Entries}.
A short explanation of the entries you must customize is provided
below.

\begin{description}

\item[\Macro{POOL\_HISTORY\_DIR}] This is the directory where
historical data will be stored.
This directory must be writable by whatever user the CondorView
collector is running as (usually the user condor).  
There is a configurable limit to the maximum space required for all
the files created by the CondorView server called
(\Macro{POOL\_HISTORY\_MAX\_STORAGE}). 

\Note This directory should be separate and different from the
\File{spool} or \File{log} directories already set up for
Condor.
There are a few problems putting these files into either of those
directories.

\item[\Macro{KEEP\_POOL\_HISTORY}] This is a boolean value that determines
if the CondorView collector should store the historical information.
It is false by default, which is why you must specify it as true in
your local configuration file to enable data collection.

\end{description}

Once these settings are in place in the local configuration file for your
CondorView server host, you must to create the directory you specified
in \MacroNI{POOL\_HISTORY\_DIR} and make it writable by the user your
CondorView collector is running as.
This is the same user that owns the \File{CollectorLog} file in
your \File{log} directory. The user is usually condor.

After you've configured the CondorView attributes, you must configure
Condor to automatically start the CondorView server. 
You do this by adding \MacroNI{VIEW\_SERVER} to the
\Macro{DAEMON\_LIST} on this machine and defining what
\Expr{VIEW\_SERVER} means.
For example:
\begin{verbatim}
        VIEW_SERVER = $(SBIN)/condor_collector
        DAEMON_LIST = MASTER, STARTD, SCHEDD, VIEW_SERVER
\end{verbatim}
For this change to take effect, you must re-start the
\Condor{master} on this host (which you can do with the
\Condor{restart} command, if you run the command from a machine with 
administrator access to your pool.
(See section~\ref{sec:Host-Security} on
page~\pageref{sec:Host-Security} for full details of IP/host-based
security in Condor).

\Note Before you spawn the CondorView server by restarting your
\Condor{master}, you should make sure \MacroNI{CONDOR\_VIEW\_HOST} is
defined in your configuration (as described in the following section).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{\label{sec:CondorView-Pool-Setup}
Configuring a Pool to Report to the CondorView Server} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

For the CondorView server to function, you must configure your pool to
send updates to it.
You do this by configuring your existing \Condor{collector} to forward
its updates to the CondorView server.
All the Condor daemons in the pool send their ClassAd updates to the
regular \Condor{collector}, which in turn will forward them onto the
CondorView server.

You do this by defining the following setting in your configuration
file:
\begin{verbatim}
        CONDOR_VIEW_HOST = full.hostname
\end{verbatim}
where \verb@full.hostname@ is the full hostname of the machine where you
are running your CondorView collector.

You should place this setting in your global configuration file, since
it should be the same for both the main \Condor{collector} and the
CondorView server.
If you do not have a shared global configuration file for Condor, you
should put the same value in the configuration files on both the main
\Condor{collector} and the CondorView server host.

Once this setting is in place, you can finally restart the
\Condor{master} at your CondorView server host (or spawn the
\Condor{master} if it is not yet running).
Once the CondorView server is running, you can finally send a
\Condor{reconfig} to your main \Condor{collector} for the change to
take effect so it will begin forwarding updates.




